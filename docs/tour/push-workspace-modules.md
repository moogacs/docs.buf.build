---
id: push-workspace-modules
title: 14 Push workspace modules
---

[Workspaces](../reference/workspaces.md) enable you to work with and modify multiple local
[modules](../bsr/overview.md#modules) at the same time. Once you're satisfied with your changes and
are ready to push them to the [BSR](../bsr/overview.md), there are a few things you should
keep in mind to make sure everything works as you expect.

## 14.1 Try to push {#try-to-push}

You successfully generated Go/gRPC client and server stubs in a [previous
step](/tour/generate-go-code.md), but if you try to push your `petapis` Protobuf module to the BSR
you'll get this error:

```terminal
$ cd petapis
$ buf push
---
Failure: pet/v1/pet.proto:5:8:payment/v1alpha1/payment.proto: does not exist.
```

This is a bit puzzling because you can successfully build the module locally:

```terminal
$ buf build
```

Recall that you can only build the module because of the
[`buf.work.yaml`](../configuration/v1/buf-work-yaml.md) file in the `start` directory. Without
this file, the `petapis` module doesn't have access to the files provided by the `paymentapis`
module.

That's because **workspaces only apply to local operations**. When you're ready to push any updates
you've made in a local workspace, you need to push each module independently, starting with the
upstream modules first. Once the upstream module's changes are published, you can update the
downstream module to fetch the latest version, and continue to push each of your modules until all
of your local changes are published to the BSR.

For the `PetStoreService`, here's the proper order for publishing updates:

1. `googleapis`
1. `paymentapis`
1. `petapis`

## 14.2 Push the `paymentapis` module {#push-the-paymentapis-module}

You haven't made any changes to the `buf.build/googleapis/googleapis` module, so you don't need to
push a new version of that module. But you just introduced the
`buf.build/$BUF_USER/paymentapis` module, so you need to create the
`buf.build/$BUF_USER/paymentapis` repository:

```terminal
$ buf beta registry repository create buf.build/$BUF_USER/paymentapis --visibility public
---
Full name                        Created
buf.build/$BUF_USER/paymentapis  ...
```

Now that the repository exists, change into the `paymentapis` directory and push the module:

```terminal
$ cd ../paymentapis
$ buf push
---
2675d6a595ac4e0fb45cedc62edfc611
```

## 14.3 Push the `petapis` module {#push-the-petapis-module}

The `buf.build/$BUF_USER/paymentapis` repository now contains the same content you have locally, so
you can add it as a dependency to the local `petapis` module:

```terminal
$ cd ../petapis
```

```yaml title="petapis/buf.yaml" {5}
 version: v1
 name: buf.build/$BUF_USER/petapis
 deps:
   - buf.build/googleapis/googleapis
+  - buf.build/$BUF_USER/paymentapis
breaking:
   use:
     - FILE
 lint:
   use:
     - DEFAULT
```

Update your dependencies with this command:

```terminal
$ buf mod update
```

Your [`buf.lock`](../configuration/v1/buf-lock.md) should now contain a reference to both
`googleapis` and `paymentapis`:

```yaml title="buf.lock"
# Generated by buf. DO NOT EDIT.
version: v1
deps:
  - remote: buf.build
    owner: $BUF_USER
    repository: paymentapis
    commit: 9a877cf260e1488d869a31fce3bea26d
  - remote: buf.build
    owner: googleapis
    repository: googleapis
    commit: 62f35d8aed1149c291d606d958a7ce32
```

You can now push the `petapis` module:

```terminal
$ buf push
---
dda6041ec265455d813f037c36c30349
```
